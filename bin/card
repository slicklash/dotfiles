#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import itertools
import random
import string
import sys
from typing import Optional

pad = lambda text, width: f"{text:<{width}}"
chunk = lambda items, size, width=None: [
    pad(items[i : i + size], width or size) for i in range(0, len(items), size)
]


class Card(object):
    def __init__(
        self,
        *,
        col_width: Optional[int] = None,
        seed: Optional[int] = None,
        charset: str = string.digits + string.ascii_letters + "@#$_&-+*()/*\"':;!?,.",
    ) -> None:
        self._col_width = col_width if col_width is not None else 3
        self._rows = [
            ["| "]
            + chunk(string.ascii_uppercase, 3, self._col_width)
            + [pad(".", self._col_width)]
        ]
        self._row_count = 9
        self._col_count = len(self._rows[0])
        self._rows.extend([["|-"] + ["-" * self._col_width] * (self._col_count - 1)])
        if seed is not None:
            self._seed = seed
            random.seed(seed)
        for i in range(self._row_count):
            row = "".join(
                random.choices(charset, k=self._col_width * (self._col_count - 1))
            )
            self._rows.append([f"|{i + 1}"] + chunk(row, self._col_width))

    def __str__(self) -> str:
        return "\n".join(
            "".join([f"{row[i]}|" for i in range(len(row))]) for row in self._rows
        )


def main():
    seed = None
    if len(sys.argv) > 1:
        s = sys.argv[1]
        seed = int(s, 16 if s[:2] == "0x" else 10)
    print(Card(seed=seed))


if __name__ == "__main__":
    main()
